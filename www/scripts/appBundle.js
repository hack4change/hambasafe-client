///<reference path="../typings/tsd.d.ts"/>
///<reference path="ref.ts"/>
var Hambasafe;
(function (Hambasafe) {
    var Client;
    (function (Client) {
        "use strict";
        var Application;
        (function (Application) {
            function initialize() {
                document.addEventListener('deviceready', onDeviceReady, false);
            }
            Application.initialize = initialize;
            function onDeviceReady() {
                // Handle the Cordova pause and resume events
                document.addEventListener('pause', onPause, false);
                document.addEventListener('resume', onResume, false);
                // TODO: Cordova has been loaded. Perform any initialization that requires Cordova here.
                var element = document.getElementById("deviceready");
                element.innerHTML = 'Device Ready';
                element.className += ' ready';
            }
            function onPause() {
                // TODO: This application has been suspended. Save application state here.
            }
            function onResume() {
                // TODO: This application has been reactivated. Restore application state here.
            }
        })(Application = Client.Application || (Client.Application = {}));
        window.onload = function () {
            Application.initialize();
        };
    })(Client = Hambasafe.Client || (Hambasafe.Client = {}));
})(Hambasafe || (Hambasafe = {}));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXBwQnVuZGxlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc2NyaXB0cy9yZWYudHMiLCIuLi8uLi9zY3JpcHRzL2FwcC50cyIsIi4uLy4uL3NjcmlwdHMvaW5kZXgudHMiLCIuLi8uLi9zY3JpcHRzL2NvbnRyb2xsZXJzL0NoYXRDdHJsLnRzIiwiLi4vLi4vc2NyaXB0cy9jb250cm9sbGVycy9DaGF0RGV0YWlsQ3RybC50cyIsIi4uLy4uL3NjcmlwdHMvY29udHJvbGxlcnMvQ3JlYXRlQ3RybC50cyIsIi4uLy4uL3NjcmlwdHMvY29udHJvbGxlcnMvRXZlbnREZXRhaWxDdHJsLnRzIiwiLi4vLi4vc2NyaXB0cy9jb250cm9sbGVycy9Ib21lQ3RybC50cyIsIi4uLy4uL3NjcmlwdHMvY29udHJvbGxlcnMvTGFuZGluZ0N0cmwudHMiLCIuLi8uLi9zY3JpcHRzL2NvbnRyb2xsZXJzL0xhdGVzdEN0cmwudHMiLCIuLi8uLi9zY3JpcHRzL2NvbnRyb2xsZXJzL01hcEN0cmwudHMiLCIuLi8uLi9zY3JpcHRzL2NvbnRyb2xsZXJzL1Byb2ZpbGVDdHJsLnRzIiwiLi4vLi4vc2NyaXB0cy9jb250cm9sbGVycy9SYXRpbmdDdHJsLnRzIiwiLi4vLi4vc2NyaXB0cy9jb250cm9sbGVycy9SZWdpc3RyYXRpb25DdHJsLnRzIiwiLi4vLi4vc2NyaXB0cy9jb250cm9sbGVycy9TZWFyY2hDdHJsLnRzIiwiLi4vLi4vc2NyaXB0cy9zZXJ2aWNlcy9DaGF0cy50cyIsIi4uLy4uL3NjcmlwdHMvc2VydmljZXMvRXZlbnRGYWN0b3J5LnRzIiwiLi4vLi4vc2NyaXB0cy9zZXJ2aWNlcy9FdmVudFNlcnZpY2UudHMiLCIuLi8uLi9zY3JpcHRzL3NlcnZpY2VzL0xvY2FsU3RvcmFnZS50cyIsIi4uLy4uL3NjcmlwdHMvc2VydmljZXMvTG9jYXRpb25TZXJ2aWNlLnRzIiwiLi4vLi4vc2NyaXB0cy9zZXJ2aWNlcy9Qcm9maWxlU2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSwwQ0FBMEM7QUNBMUMsNkJBQTZCO0FDSTdCLElBQU8sU0FBUyxDQWdDZjtBQWhDRCxXQUFPLFNBQVM7SUFBQyxJQUFBLE1BQU0sQ0FnQ3RCO0lBaENnQixXQUFBLE1BQU0sRUFBQyxDQUFDO1FBQ3JCLFlBQVksQ0FBQztRQUViLElBQWMsV0FBVyxDQXdCeEI7UUF4QkQsV0FBYyxXQUFXLEVBQUMsQ0FBQztZQUN2QjtnQkFDSSxRQUFRLENBQUMsZ0JBQWdCLENBQUMsYUFBYSxFQUFFLGFBQWEsRUFBRSxLQUFLLENBQUMsQ0FBQztZQUNuRSxDQUFDO1lBRmUsc0JBQVUsYUFFekIsQ0FBQTtZQUVEO2dCQUNJLDZDQUE2QztnQkFDN0MsUUFBUSxDQUFDLGdCQUFnQixDQUFDLE9BQU8sRUFBRSxPQUFPLEVBQUUsS0FBSyxDQUFDLENBQUM7Z0JBQ25ELFFBQVEsQ0FBQyxnQkFBZ0IsQ0FBQyxRQUFRLEVBQUUsUUFBUSxFQUFFLEtBQUssQ0FBQyxDQUFDO2dCQUVyRCx3RkFBd0Y7Z0JBQ3hGLElBQUksT0FBTyxHQUFHLFFBQVEsQ0FBQyxjQUFjLENBQUMsYUFBYSxDQUFDLENBQUM7Z0JBQ3JELE9BQU8sQ0FBQyxTQUFTLEdBQUcsY0FBYyxDQUFDO2dCQUNuQyxPQUFPLENBQUMsU0FBUyxJQUFJLFFBQVEsQ0FBQztZQUNsQyxDQUFDO1lBRUQ7Z0JBQ0ksMEVBQTBFO1lBQzlFLENBQUM7WUFFRDtnQkFDSSwrRUFBK0U7WUFDbkYsQ0FBQztRQUVMLENBQUMsRUF4QmEsV0FBVyxHQUFYLGtCQUFXLEtBQVgsa0JBQVcsUUF3QnhCO1FBRUQsTUFBTSxDQUFDLE1BQU0sR0FBRztZQUNaLFdBQVcsQ0FBQyxVQUFVLEVBQUUsQ0FBQztRQUM3QixDQUFDLENBQUE7SUFDTCxDQUFDLEVBaENnQixNQUFNLEdBQU4sZ0JBQU0sS0FBTixnQkFBTSxRQWdDdEI7QUFBRCxDQUFDLEVBaENNLFNBQVMsS0FBVCxTQUFTLFFBZ0NmIiwic291cmNlc0NvbnRlbnQiOlsiLy8vPHJlZmVyZW5jZSBwYXRoPVwiLi4vdHlwaW5ncy90c2QuZC50c1wiLz5cbiIsIi8vLzxyZWZlcmVuY2UgcGF0aD1cInJlZi50c1wiLz5cclxuXHJcbmV4cG9ydCB2YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ3N0YXJ0ZXInLCBbJ3VpLnJvdXRlcicsICdpb25pYycsIFwiTG9jYWxTdG9yYWdlTW9kdWxlXCIsICdmYWNlYm9vaycsICduZ1Jlc291cmNlJ10pXHJcbiAgLmNvbnRyb2xsZXIoJ0Fib3V0VXNDdHJsJywgZnVuY3Rpb24gKCkgeyB9KVxyXG4gIC5jb250cm9sbGVyKCdBY2NvdW50Q3RybCcsIGZ1bmN0aW9uICgpIHsgfSlcclxuICAuY29udHJvbGxlcignRGFzaEN0cmwnLCBmdW5jdGlvbiAoKSB7IH0pXHJcbiAgLmNvbnRyb2xsZXIoJ0V2ZW50UmF0aW5nQ3RybCcsIGZ1bmN0aW9uICgpIHsgfSlcclxuICAuY29udHJvbGxlcignVGVsbGFGcmllbmRDdHJsJywgZnVuY3Rpb24gKCkgeyB9KVxyXG4gIC5jb250cm9sbGVyKCdUZXJtc0N0cmwnLCBmdW5jdGlvbiAoKSB7IH0pXHJcbiAgLmNvbnN0YW50KCdjb25maWcnLCB7XHJcbiAgICBiYXNlU2VydmljZVVSTDogXCJodHRwOi8vaHNkZXZhcGkxLmF6dXJld2Vic2l0ZXMubmV0XCJcclxuICAgIC8vYmFzZVNlcnZpY2VVUkw6IFwiaHR0cDovL2FwaS5lbWd1aWRhbmNlLmNvbS9vcGVubWVkL2FwaVwiXHJcbiAgfSlcclxuXHJcbiAgLnJ1bihmdW5jdGlvbiAoJGlvbmljUGxhdGZvcm0pIHtcclxuICAgICRpb25pY1BsYXRmb3JtLnJlYWR5KGZ1bmN0aW9uICgpIHtcclxuICAgICAgLy8gSGlkZSB0aGUgYWNjZXNzb3J5IGJhciBieSBkZWZhdWx0IChyZW1vdmUgdGhpcyB0byBzaG93IHRoZSBhY2Nlc3NvcnkgYmFyIGFib3ZlIHRoZSBrZXlib2FyZFxyXG4gICAgICAvLyBmb3IgZm9ybSBpbnB1dHMpXHJcbiAgICAgIGlmICh3aW5kb3cuY29yZG92YSAmJiAoPGFueT53aW5kb3cuY29yZG92YSkucGx1Z2lucyAmJiAoPGFueT53aW5kb3cuY29yZG92YSkucGx1Z2lucy5LZXlib2FyZCkge1xyXG4gICAgICAgICg8YW55PmNvcmRvdmEpLnBsdWdpbnMuS2V5Ym9hcmQuaGlkZUtleWJvYXJkQWNjZXNzb3J5QmFyKHRydWUpO1xyXG4gICAgICAgICg8YW55PmNvcmRvdmEpLnBsdWdpbnMuS2V5Ym9hcmQuZGlzYWJsZVNjcm9sbCh0cnVlKTtcclxuXHJcbiAgICAgIH1cclxuICAgICAgaWYgKHdpbmRvdy5TdGF0dXNCYXIpIHtcclxuICAgICAgICAvLyBvcmcuYXBhY2hlLmNvcmRvdmEuc3RhdHVzYmFyIHJlcXVpcmVkXHJcbiAgICAgICAgKDxhbnk+d2luZG93KS5TdGF0dXNCYXIuc3R5bGVEZWZhdWx0KCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vJGZhY2Vib29rUHJvdmlkZXIuc2V0QXBwSWQoMjg5NDgyMzkwNjg4KVxyXG5cclxuXHJcbiAgICB9KTtcclxuICB9KVxyXG5cclxuICAuY29uZmlnKGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlciwgJHVybFJvdXRlclByb3ZpZGVyLCBGYWNlYm9va1Byb3ZpZGVyLCAkaHR0cFByb3ZpZGVyKSB7XHJcblxyXG4gICAgJGh0dHBQcm92aWRlci5kZWZhdWx0cy51c2VYRG9tYWluID0gdHJ1ZTtcclxuICAgIEZhY2Vib29rUHJvdmlkZXIuaW5pdCgnMjg5NDgyMzkwNjg4Jyk7XHJcblxyXG4gICAgLy8gSW9uaWMgdXNlcyBBbmd1bGFyVUkgUm91dGVyIHdoaWNoIHVzZXMgdGhlIGNvbmNlcHQgb2Ygc3RhdGVzXHJcbiAgICAvLyBMZWFybiBtb3JlIGhlcmU6IGh0dHBzOi8vZ2l0aHViLmNvbS9hbmd1bGFyLXVpL3VpLXJvdXRlclxyXG4gICAgLy8gU2V0IHVwIHRoZSB2YXJpb3VzIHN0YXRlcyB3aGljaCB0aGUgYXBwIGNhbiBiZSBpbi5cclxuICAgIC8vIEVhY2ggc3RhdGUncyBjb250cm9sbGVyIGNhbiBiZSBmb3VuZCBpbiBjb250cm9sbGVycy5qc1xyXG4gICAgJHN0YXRlUHJvdmlkZXJcclxuXHJcbiAgICAgIC8vIHNldHVwIGFuIGFic3RyYWN0IHN0YXRlIGZvciB0aGUgdGFicyBkaXJlY3RpdmVcclxuICAgICAgLnN0YXRlKCdhcHAubGFuZGluZycsIHtcclxuICAgICAgICB1cmw6ICcvbGFuZGluZycsXHJcbiAgICAgICAgdmlld3M6IHtcclxuICAgICAgICAgICdtZW51Q29udGVudCc6IHtcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvbGFuZGluZy5odG1sJyxcclxuICAgICAgICAgICAgY29udHJvbGxlcjogJ0xhbmRpbmdDdHJsJ1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSlcclxuXHJcbiAgICAgIC5zdGF0ZSgnYXBwJywge1xyXG4gICAgICAgIHVybDogXCIvYXBwXCIsXHJcbiAgICAgICAgYWJzdHJhY3Q6IHRydWUsXHJcbiAgICAgICAgdGVtcGxhdGVVcmw6IFwidGVtcGxhdGVzL21lbnUuaHRtbFwiLFxyXG4gICAgICAgIC8vIGNvbnRyb2xsZXI6ICdBcHBDdHJsJ1xyXG4gICAgICB9KVxyXG5cclxuICAgICAgLnN0YXRlKCdhcHAuZW1lcmdlbmN5Jywge1xyXG4gICAgICAgIHVybDogXCIvZW1lcmdlbmN5XCIsXHJcbiAgICAgICAgdmlld3M6IHtcclxuICAgICAgICAgICdtZW51Q29udGVudCc6IHtcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6IFwidGVtcGxhdGVzL2VtZXJnZW5jeS5odG1sXCIsXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG4gICAgICAuc3RhdGUoJ2FwcC5yZWdpc3RyYXRpb24nLCB7XHJcbiAgICAgICAgdXJsOiAnL3JlZ2lzdHJhdGlvbicsXHJcbiAgICAgICAgdmlld3M6IHtcclxuICAgICAgICAgICdtZW51Q29udGVudCc6IHtcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvcmVnaXN0cmF0aW9uLmh0bWwnLFxyXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnUmVnaXN0cmF0aW9uQ3RybCdcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcblxyXG4gICAgICAuc3RhdGUoJ2FwcC5ob21lJywge1xyXG4gICAgICAgIHVybDogJy9ob21lJyxcclxuICAgICAgICB2aWV3czoge1xyXG4gICAgICAgICAgJ21lbnVDb250ZW50Jzoge1xyXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy9ob21lLmh0bWwnLFxyXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnSG9tZUN0cmwnXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG5cclxuICAgICAgLnN0YXRlKCdhcHAudGVybXMnLCB7XHJcbiAgICAgICAgdXJsOiAnL3Rlcm1zJyxcclxuICAgICAgICB2aWV3czoge1xyXG4gICAgICAgICAgJ21lbnVDb250ZW50Jzoge1xyXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy90ZXJtcy5odG1sJyxcclxuICAgICAgICAgICAgY29udHJvbGxlcjogJ1Rlcm1zQ3RybCdcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcblxyXG4gICAgICAuc3RhdGUoJ2FwcC5hYm91dC11cycsIHtcclxuICAgICAgICB1cmw6ICcvYWJvdXQtdXMnLFxyXG4gICAgICAgIHZpZXdzOiB7XHJcbiAgICAgICAgICAnbWVudUNvbnRlbnQnOiB7XHJcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL2Fib3V0LXVzLmh0bWwnLFxyXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnQWJvdXRVc0N0cmwnXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG4gICAgICAuc3RhdGUoJ2FwcC50ZWxsLWEtZnJpZW5kJywge1xyXG4gICAgICAgIHVybDogJy90ZWxsLWEtZnJpZW5kJyxcclxuICAgICAgICB2aWV3czoge1xyXG4gICAgICAgICAgJ21lbnVDb250ZW50Jzoge1xyXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy9hYm91dC11cy5odG1sJyxcclxuICAgICAgICAgICAgY29udHJvbGxlcjogJ1RlbGxhRnJpZW5kQ3RybCdcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcbiAgICAgIC5zdGF0ZSgndGFiJywge1xyXG4gICAgICAgIHVybDogJy90YWInLFxyXG4gICAgICAgIGFic3RyYWN0OiB0cnVlLFxyXG4gICAgICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL3RhYnMuaHRtbCdcclxuICAgICAgfSlcclxuXHJcbiAgICAgIC5zdGF0ZSgnbGF0ZXN0Jywge1xyXG4gICAgICAgIHVybDogJy9sYXRlc3QnLFxyXG4gICAgICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL2xhdGVzdC5odG1sJyxcclxuICAgICAgICBjb250cm9sbGVyOiAnTGF0ZXN0Q3RybCdcclxuICAgICAgfSlcclxuXHJcbiAgICAgIC5zdGF0ZSgnYXBwLmV2ZW50LWRldGFpbCcsIHtcclxuICAgICAgICB1cmw6ICcvZXZlbnQtZGV0YWlsLzppZCcsXHJcbiAgICAgICAgdmlld3M6IHtcclxuICAgICAgICAgICdtZW51Q29udGVudCc6IHtcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvZXZlbnQtZGV0YWlsLmh0bWwnLFxyXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnRXZlbnREZXRhaWxDdHJsJ1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSlcclxuXHJcbiAgICAgIC5zdGF0ZSgnYXBwLmNyZWF0ZScsIHtcclxuICAgICAgICB1cmw6ICcvY3JlYXRlJyxcclxuICAgICAgICB2aWV3czoge1xyXG4gICAgICAgICAgJ21lbnVDb250ZW50Jzoge1xyXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy9jcmVhdGUuaHRtbCcsXHJcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdDcmVhdGVDdHJsJ1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSlcclxuXHJcbiAgICAgIC5zdGF0ZSgnYXBwLm1hcCcsIHtcclxuICAgICAgICB1cmw6ICcvbWFwJyxcclxuICAgICAgICB2aWV3czoge1xyXG4gICAgICAgICAgJ21lbnVDb250ZW50Jzoge1xyXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy9tYXAuaHRtbCcsXHJcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdNYXBDdHJsJ1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSlcclxuICAgICAgLnN0YXRlKCdhcHAucmF0aW5nJywge1xyXG4gICAgICAgIHVybDogJy9yYXRpbmcnLFxyXG4gICAgICAgIHZpZXdzOiB7XHJcbiAgICAgICAgICAnbWVudUNvbnRlbnQnOiB7XHJcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL3JhdGluZy5odG1sJyxcclxuICAgICAgICAgICAgY29udHJvbGxlcjogJ1JhdGluZ0N0cmwnXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG5cclxuICAgICAgLnN0YXRlKCdhcHAuc2VhcmNoJywge1xyXG4gICAgICAgIHVybDogJy9zZWFyY2g/bG5nJmxhdCZkaXN0JyxcclxuICAgICAgICB2aWV3czoge1xyXG4gICAgICAgICAgJ21lbnVDb250ZW50Jzoge1xyXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy9zZWFyY2guaHRtbCcsXHJcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdTZWFyY2hDdHJsJ1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSlcclxuICAgICAgLnN0YXRlKCdhcHAucHJvZmlsZScsIHtcclxuICAgICAgICB1cmw6ICcvcHJvZmlsZScsXHJcbiAgICAgICAgdmlld3M6IHtcclxuICAgICAgICAgICdtZW51Q29udGVudCc6IHtcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvcHJvZmlsZS5odG1sJyxcclxuICAgICAgICAgICAgY29udHJvbGxlcjogJ1Byb2ZpbGVDdHJsJ1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSlcclxuXHJcbiAgICAgIC5zdGF0ZSgndGFiLmRhc2gnLCB7XHJcbiAgICAgICAgdXJsOiAnL2Rhc2gnLFxyXG4gICAgICAgIHZpZXdzOiB7XHJcbiAgICAgICAgICAndGFiLWRhc2gnOiB7XHJcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL3RhYi1kYXNoLmh0bWwnLFxyXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnRGFzaEN0cmwnXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG5cclxuICAgICAgLnN0YXRlKCd0YWIuY2hhdHMnLCB7XHJcbiAgICAgICAgdXJsOiAnL2NoYXRzJyxcclxuICAgICAgICB2aWV3czoge1xyXG4gICAgICAgICAgJ3RhYi1jaGF0cyc6IHtcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvdGFiLWNoYXRzLmh0bWwnLFxyXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnQ2hhdHNDdHJsJ1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSlcclxuXHJcbiAgICAgIC5zdGF0ZSgndGFiLmNoYXQtZGV0YWlsJywge1xyXG4gICAgICAgIHVybDogJy9jaGF0cy86Y2hhdElkJyxcclxuICAgICAgICB2aWV3czoge1xyXG4gICAgICAgICAgJ3RhYi1jaGF0cyc6IHtcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvY2hhdC1kZXRhaWwuaHRtbCcsXHJcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdDaGF0RGV0YWlsQ3RybCdcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcblxyXG4gICAgICAuc3RhdGUoJ3RhYi5hY2NvdW50Jywge1xyXG4gICAgICAgIHVybDogJy9hY2NvdW50JyxcclxuICAgICAgICB2aWV3czoge1xyXG4gICAgICAgICAgJ3RhYi1hY2NvdW50Jzoge1xyXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy90YWItYWNjb3VudC5odG1sJyxcclxuICAgICAgICAgICAgY29udHJvbGxlcjogJ0FjY291bnRDdHJsJ1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSlcclxuXHJcbiAgICAgIC5zdGF0ZSgnYXBwLnVzZXJJbnZpdGUnLCB7XHJcbiAgICAgICAgdXJsOiAnL3VzZXItaW52aXRlJyxcclxuICAgICAgICB2aWV3czoge1xyXG4gICAgICAgICAgJ21lbnVDb250ZW50Jzoge1xyXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy91c2VyLWludml0ZS5odG1sJyxcclxuICAgICAgICAgICAgY29udHJvbGxlcjogJydcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcbiAgICAvLyBpZiBub25lIG9mIHRoZSBhYm92ZSBzdGF0ZXMgYXJlIG1hdGNoZWQsIHVzZSB0aGlzIGFzIHRoZSBmYWxsYmFja1xyXG4gICAgJHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZSgnL2FwcC9sYW5kaW5nJyk7XHJcbiAgfSk7XHJcbiIsIi8vIEZvciBhbiBpbnRyb2R1Y3Rpb24gdG8gdGhlIEJsYW5rIHRlbXBsYXRlLCBzZWUgdGhlIGZvbGxvd2luZyBkb2N1bWVudGF0aW9uOlxyXG4vLyBodHRwOi8vZ28ubWljcm9zb2Z0LmNvbS9md2xpbmsvP0xpbmtJRD0zOTc3MDVcclxuLy8gVG8gZGVidWcgY29kZSBvbiBwYWdlIGxvYWQgaW4gUmlwcGxlIG9yIG9uIEFuZHJvaWQgZGV2aWNlcy9lbXVsYXRvcnM6IGxhdW5jaCB5b3VyIGFwcCwgc2V0IGJyZWFrcG9pbnRzLCBcclxuLy8gYW5kIHRoZW4gcnVuIFwid2luZG93LmxvY2F0aW9uLnJlbG9hZCgpXCIgaW4gdGhlIEphdmFTY3JpcHQgQ29uc29sZS5cclxubW9kdWxlIEhhbWJhc2FmZS5DbGllbnQge1xyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4gICAgZXhwb3J0IG1vZHVsZSBBcHBsaWNhdGlvbiB7XHJcbiAgICAgICAgZXhwb3J0IGZ1bmN0aW9uIGluaXRpYWxpemUoKSB7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2RldmljZXJlYWR5Jywgb25EZXZpY2VSZWFkeSwgZmFsc2UpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gb25EZXZpY2VSZWFkeSgpIHtcclxuICAgICAgICAgICAgLy8gSGFuZGxlIHRoZSBDb3Jkb3ZhIHBhdXNlIGFuZCByZXN1bWUgZXZlbnRzXHJcbiAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3BhdXNlJywgb25QYXVzZSwgZmFsc2UpO1xyXG4gICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdyZXN1bWUnLCBvblJlc3VtZSwgZmFsc2UpO1xyXG5cclxuICAgICAgICAgICAgLy8gVE9ETzogQ29yZG92YSBoYXMgYmVlbiBsb2FkZWQuIFBlcmZvcm0gYW55IGluaXRpYWxpemF0aW9uIHRoYXQgcmVxdWlyZXMgQ29yZG92YSBoZXJlLlxyXG4gICAgICAgICAgICB2YXIgZWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZGV2aWNlcmVhZHlcIik7XHJcbiAgICAgICAgICAgIGVsZW1lbnQuaW5uZXJIVE1MID0gJ0RldmljZSBSZWFkeSc7XHJcbiAgICAgICAgICAgIGVsZW1lbnQuY2xhc3NOYW1lICs9ICcgcmVhZHknO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gb25QYXVzZSgpIHtcclxuICAgICAgICAgICAgLy8gVE9ETzogVGhpcyBhcHBsaWNhdGlvbiBoYXMgYmVlbiBzdXNwZW5kZWQuIFNhdmUgYXBwbGljYXRpb24gc3RhdGUgaGVyZS5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIG9uUmVzdW1lKCkge1xyXG4gICAgICAgICAgICAvLyBUT0RPOiBUaGlzIGFwcGxpY2F0aW9uIGhhcyBiZWVuIHJlYWN0aXZhdGVkLiBSZXN0b3JlIGFwcGxpY2F0aW9uIHN0YXRlIGhlcmUuXHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICB3aW5kb3cub25sb2FkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIEFwcGxpY2F0aW9uLmluaXRpYWxpemUoKTtcclxuICAgIH1cclxufVxyXG4iLCJpbXBvcnQge2FwcH0gZnJvbSBcIi4uL2FwcFwiO1xuXG5hcHAuY29udHJvbGxlcignQ2hhdHNDdHJsJywgZnVuY3Rpb24gKCRzY29wZSwgQ2hhdHMpIHtcclxuICAvLyBXaXRoIHRoZSBuZXcgdmlldyBjYWNoaW5nIGluIElvbmljLCBDb250cm9sbGVycyBhcmUgb25seSBjYWxsZWRcclxuICAvLyB3aGVuIHRoZXkgYXJlIHJlY3JlYXRlZCBvciBvbiBhcHAgc3RhcnQsIGluc3RlYWQgb2YgZXZlcnkgcGFnZSBjaGFuZ2UuXHJcbiAgLy8gVG8gbGlzdGVuIGZvciB3aGVuIHRoaXMgcGFnZSBpcyBhY3RpdmUgKGZvciBleGFtcGxlLCB0byByZWZyZXNoIGRhdGEpLFxyXG4gIC8vIGxpc3RlbiBmb3IgdGhlICRpb25pY1ZpZXcuZW50ZXIgZXZlbnQ6XHJcbiAgLy9cclxuICAvLyRzY29wZS4kb24oJyRpb25pY1ZpZXcuZW50ZXInLCBmdW5jdGlvbihlKSB7XHJcbiAgLy99KTtcclxuXHJcbiAgJHNjb3BlLmNoYXRzID0gQ2hhdHMuYWxsKCk7XHJcbiAgJHNjb3BlLnJlbW92ZSA9IGZ1bmN0aW9uIChjaGF0KSB7XHJcbiAgICBDaGF0cy5yZW1vdmUoY2hhdCk7XHJcbiAgfTtcclxufSk7XHJcbiIsImltcG9ydCB7YXBwfSBmcm9tIFwiLi4vYXBwXCI7XG5hcHAuY29udHJvbGxlcignQ2hhdERldGFpbEN0cmwnLCBmdW5jdGlvbiAoJHNjb3BlLCAkc3RhdGVQYXJhbXMsIENoYXRzKSB7XHJcbiAgJHNjb3BlLmNoYXQgPSBDaGF0cy5nZXQoJHN0YXRlUGFyYW1zLmNoYXRJZCk7XHJcbn0pO1xyXG4iLCJpbXBvcnQge2FwcH0gZnJvbSBcIi4uL2FwcFwiO1xuYXBwLmNvbnRyb2xsZXIoJ0NyZWF0ZUN0cmwnLCBmdW5jdGlvbiAoJHNjb3BlLCBFdmVudEZhY3RvcnkpIHtcclxuICAvL2luaXRcclxuICAoZnVuY3Rpb24gKCkge1xyXG4gICAgJHNjb3BlLnNob3duR3JvdXAgPSBudWxsO1xyXG4gICAgJHNjb3BlLm9wdGlvbnMgPSB7fTtcclxuICB9KSgpXHJcblxyXG5cclxuICAkc2NvcGUuc2VhcmNoRXZlbnRzID0gZnVuY3Rpb24gKCkge1xyXG5cclxuICAgIEV2ZW50RmFjdG9yeS5jcmVhdGUoXHJcbiAgICAgIHtpZDogMX0sXHJcbiAgICAgIGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgICRzY29wZS5ldmVudERhdGEgPSBldmVudDtcclxuICAgICAgfSxcclxuICAgICAgZnVuY3Rpb24gKGVycm9yKSB7XHJcblxyXG4gICAgICB9KTtcclxuICB9XHJcbiAgJHNjb3BlLmV2ZW50VHlwZSA9IFtcIldhbGtcIiwgXCJSdW5cIiwgXCJDeWNsZVwiXTsgLy9jb252ZXJ0IHRvIGFycmF5IG9mIG9iamVjdHNcclxuICAkc2NvcGUudHlwZVNlbGVjdGVkID0gJHNjb3BlLmV2ZW50VHlwZVswXTtcclxuICAkc2NvcGUuY3JlYXRlID0gZnVuY3Rpb24gKCkge1xyXG5cclxuICB9XHJcblxyXG4gICRzY29wZS50b2dnbGVHcm91cCA9IGZ1bmN0aW9uIChncm91cCkge1xyXG4gICAgaWYgKCRzY29wZS5pc0dyb3VwU2hvd24oZ3JvdXApKSB7XHJcbiAgICAgICRzY29wZS5zaG93bkdyb3VwID0gbnVsbDtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICRzY29wZS5zaG93bkdyb3VwID0gZ3JvdXA7XHJcbiAgICB9XHJcbiAgfTtcclxuICAkc2NvcGUudG9nZ2xlU2VsZWN0aW9uID0gZnVuY3Rpb24gKHNlbGVjdGVkLCBncm91cCkge1xyXG4gICAgJHNjb3BlLnR5cGVTZWxlY3RlZCA9IHNlbGVjdGVkO1xyXG4gICAgJHNjb3BlLnRvZ2dsZUdyb3VwKGdyb3VwKTtcclxuICB9O1xyXG5cclxuICAkc2NvcGUuaXNHcm91cFNob3duID0gZnVuY3Rpb24gKHR5cGUsIGdyb3VwKSB7XHJcbiAgICByZXR1cm4gJHNjb3BlLnNob3duR3JvdXAgPT09IGdyb3VwICYmICRzY29wZS50eXBlU2VsZWN0ZWQgIT09IHR5cGU7XHJcbiAgfTtcclxuXHJcbiAgJHNjb3BlLmlzU2hvd24gPSBmdW5jdGlvbiAodHlwZSwgZ3JvdXApIHtcclxuICAgIHJldHVybiAkc2NvcGUuc2hvd25Hcm91cCA9PT0gZ3JvdXAgJiYgJHNjb3BlLnR5cGVTZWxlY3RlZCAhPT0gdHlwZTtcclxuICB9O1xyXG5cclxuICAkc2NvcGUuY3JlYXRlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgY29uc29sZS5sb2codGhpcy5kZXRhaWxzKTtcclxuICAgIGNvbnNvbGUubG9nKHRoaXMucmVzdWx0KTtcclxuICAgIGdlbmVyYXRlTG9jYXRpb25Gcm9tQXV0b0NvbXBsZXRlKHRoaXMuZGV0YWlscyk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBnZW5lcmF0ZUxvY2F0aW9uRnJvbUF1dG9Db21wbGV0ZShkZXRhaWxzKSB7XHJcbiAgICB2YXIgbG9jYXRpb24gOmFueT0ge307XHJcbiAgICBsb2NhdGlvbi5BZGRyZXNzID0gZGV0YWlscy5mb3JtYXR0ZWRfYWRkcmVzcztcclxuICAgIGxvY2F0aW9uLlN1YnVyYiA9IGV4dHJhY3RTdWJ1cmIoZGV0YWlscy5hZGRyZXNzX2NvbXBvbmVudHMpO1xyXG4gICAgbG9jYXRpb24uQ2l0eSA9IGV4dHJhY3RDaXR5KGRldGFpbHMuYWRkcmVzc19jb21wb25lbnRzKTtcclxuICAgIGxvY2F0aW9uLlByb3ZpbmNlID0gZXh0cmFjdFByb3ZpbmNlKGRldGFpbHMuYWRkcmVzc19jb21wb25lbnRzKTtcclxuICAgIGxvY2F0aW9uLkNvdW50cnkgPSBleHRyYWN0Q291bnRyeShkZXRhaWxzLmFkZHJlc3NfY29tcG9uZW50cyk7XHJcbiAgICBsb2NhdGlvbi5MYXRpdHVkZSA9IGRldGFpbHMuZ2VvbWV0cnkubG9jYXRpb24ubGF0KCk7XHJcbiAgICBsb2NhdGlvbi5Mb25ndGl0dWRlID0gZGV0YWlscy5nZW9tZXRyeS5sb2NhdGlvbi5sbmcoKTtcclxuICAgIGNvbnNvbGUubG9nKGxvY2F0aW9uKTtcclxuICAgIHJldHVybiBsb2NhdGlvbjtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGV4dHJhY3RTdWJ1cmIocmVzdWx0cykge1xyXG4gICAgdmFyIHN1YnVyYlJlc3VsdHM7XHJcbiAgICBzdWJ1cmJSZXN1bHRzID0gZmluZFR5cGUoJ3N1YmxvY2FsaXR5X2xldmVsXzInLCByZXN1bHRzKTtcclxuICAgIGlmIChzdWJ1cmJSZXN1bHRzICYmIHN1YnVyYlJlc3VsdHMubGVuZ3RoICYmIHN1YnVyYlJlc3VsdHMubGVuZ3RoID4gMClcclxuICAgICAgcmV0dXJuIHN1YnVyYlJlc3VsdHNbMF0ubG9uZ19uYW1lO1xyXG5cclxuICAgIHN1YnVyYlJlc3VsdHMgPSBmaW5kVHlwZSgnc3VibG9jYWxpdHlfbGV2ZWxfMScsIHJlc3VsdHMpO1xyXG4gICAgaWYgKHN1YnVyYlJlc3VsdHMgJiYgc3VidXJiUmVzdWx0cy5sZW5ndGggJiYgc3VidXJiUmVzdWx0cy5sZW5ndGggPiAwKVxyXG4gICAgICByZXR1cm4gc3VidXJiUmVzdWx0c1swXS5sb25nX25hbWU7XHJcblxyXG4gICAgc3VidXJiUmVzdWx0cyA9IGZpbmRUeXBlKCdzdWJsb2NhbGl0eScsIHJlc3VsdHMpO1xyXG4gICAgaWYgKHN1YnVyYlJlc3VsdHMgJiYgc3VidXJiUmVzdWx0cy5sZW5ndGggJiYgc3VidXJiUmVzdWx0cy5sZW5ndGggPiAwKVxyXG4gICAgICByZXR1cm4gc3VidXJiUmVzdWx0c1swXS5sb25nX25hbWU7XHJcblxyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBleHRyYWN0Q2l0eShyZXN1bHRzKSB7XHJcbiAgICB2YXIgc3VidXJiUmVzdWx0cztcclxuICAgIHN1YnVyYlJlc3VsdHMgPSBmaW5kVHlwZSgnbG9jYWxpdHknLCByZXN1bHRzKTtcclxuICAgIGlmIChzdWJ1cmJSZXN1bHRzICYmIHN1YnVyYlJlc3VsdHMubGVuZ3RoID4gMClcclxuICAgICAgcmV0dXJuIHN1YnVyYlJlc3VsdHNbMF0ubG9uZ19uYW1lO1xyXG5cclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gZXh0cmFjdFByb3ZpbmNlKHJlc3VsdHMpIHtcclxuICAgIHZhciBzdWJ1cmJSZXN1bHRzO1xyXG4gICAgc3VidXJiUmVzdWx0cyA9IGZpbmRUeXBlKCdhZG1pbmlzdHJhdGl2ZV9hcmVhX2xldmVsXzEnLCByZXN1bHRzKTtcclxuICAgIGlmIChzdWJ1cmJSZXN1bHRzICYmIHN1YnVyYlJlc3VsdHMubGVuZ3RoICYmIHN1YnVyYlJlc3VsdHMubGVuZ3RoID4gMClcclxuICAgICAgcmV0dXJuIHN1YnVyYlJlc3VsdHNbMF0ubG9uZ19uYW1lO1xyXG5cclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gZXh0cmFjdENvdW50cnkocmVzdWx0cykge1xyXG4gICAgdmFyIHN1YnVyYlJlc3VsdHM7XHJcbiAgICBzdWJ1cmJSZXN1bHRzID0gZmluZFR5cGUoJ2NvdW50cnknLCByZXN1bHRzKTtcclxuICAgIGlmIChzdWJ1cmJSZXN1bHRzICYmIHN1YnVyYlJlc3VsdHMubGVuZ3RoICYmIHN1YnVyYlJlc3VsdHMubGVuZ3RoID4gMClcclxuICAgICAgcmV0dXJuIHN1YnVyYlJlc3VsdHNbMF0ubG9uZ19uYW1lO1xyXG5cclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gZmluZFR5cGUodHlwZSwgYWRkcmVzc0NvbXBvbmVudHMpIHtcclxuICAgIHZhciByZXN1bHRzID0gW107XHJcblxyXG4gICAgaWYoIWFkZHJlc3NDb21wb25lbnRzKSB7XHJcbiAgICAgIHJldHVybiByZXN1bHRzO1xyXG4gICAgfVxyXG5cclxuICAgIHZhciBpID0gMDtcclxuICAgIGZvciAoaSA9IDA7IGkgPCBhZGRyZXNzQ29tcG9uZW50cy5sZW5ndGg7IGkrKykge1xyXG4gICAgICB2YXIgYWRkcmVzc0NvbXBvbmVudCA9IGFkZHJlc3NDb21wb25lbnRzW2ldO1xyXG4gICAgICBpZiAoYWRkcmVzc0NvbXBvbmVudCAhPSBudWxsICYmIGFkZHJlc3NDb21wb25lbnQudHlwZXMgIT0gbnVsbCkge1xyXG4gICAgICAgIHZhciBqID0gMDtcclxuICAgICAgICBmb3IgKGogPSAwOyBqIDwgYWRkcmVzc0NvbXBvbmVudC50eXBlcy5sZW5ndGg7IGorKykge1xyXG4gICAgICAgICAgdmFyIGxvY2FsVHlwZSA9IGFkZHJlc3NDb21wb25lbnQudHlwZXNbal07XHJcbiAgICAgICAgICBjb25zb2xlLmxvZyhcImxvY2FsIHR5cGU6IFwiICsgbG9jYWxUeXBlICsgXCIgLSBcIiArIGFkZHJlc3NDb21wb25lbnQubG9uZ19uYW1lKTtcclxuICAgICAgICAgIGlmICh0eXBlID09IGxvY2FsVHlwZSkge1xyXG4gICAgICAgICAgICByZXN1bHRzLnB1c2goYWRkcmVzc0NvbXBvbmVudCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJlc3VsdHM7XHJcbiAgfVxyXG59KTtcclxuIiwiaW1wb3J0IHthcHB9IGZyb20gXCIuLi9hcHBcIjtcbmFwcC5jb250cm9sbGVyKCdFdmVudERldGFpbEN0cmwnLCBmdW5jdGlvbiAoJHNjb3BlLCAkbG9jYXRpb24sIEV2ZW50RmFjdG9yeSkge1xyXG5cclxuICAgICAgLy8gJHNjb3BlLmV2ZW50RGF0YSA9IHtcclxuICAgICAgLy8gICAgIGF0dGVuZGluZzogZmFsc2UsXHJcbiAgICAgIC8vICAgICBsb2NhdGlvbjogXCJDQVBFIFRPV04sIFJPTkRFQk9TSFwiLFxyXG4gICAgICAvLyAgICAgdGl0bGU6IFwiQ3ljbGluZyBpbiBudW1iZXJzXCIsXHJcbiAgICAgIC8vICAgICB0eXBlOiBcIkNZQ0xFXCIsXHJcbiAgICAgIC8vICAgICBkaXN0YW5jZTogXCI1S01cIixcclxuICAgICAgLy8gICAgIGxldmVsOiBcIk5PVklDRVwiLFxyXG4gICAgICAvLyAgICAgZGF0ZTogXCIyMCBOb3ZlbWJlciAyMDE1XCIsXHJcbiAgICAgIC8vICAgICBzdW1tYXJ5OiBcIlRoaXMgaXMgYSAnRmFjZWJvb2snIHN0eWxlZCBDYXJkLiBUaGUgaGVhZGVyIGlzIGNyZWF0ZWQgZnJvbSBhIFRodW1ibmFpbCBMaXN0IGl0ZW0sICAgICAgICB0aGUgY29udGVudCBpcyBmcm9tIGEgY2FyZC1ib2R5IGNvbnNpc3Rpbmcgb2YgYW4gaW1hZ2UgYW5kIHBhcmFncmFwaCB0ZXh0LiBUaGUgZm9vdGVyIGNvbnNpc3RzIG9mIHRhYnMsIGljb25zIGFsaWduZWQgbGVmdCwgd2l0aGluIHRoZSBjYXJkLWZvb3Rlci5cIixcclxuICAgICAgLy8gICAgIG51bWJlck9mQXR0ZW5kZWVzOiBcIjRcIlxyXG4gICAgICAvLyB9XHJcbiAgICAgICRzY29wZS5ldmVudERhdGEgPSB7fTtcclxuICAgICAgJHNjb3BlLmluaXQgPSBmdW5jdGlvbigpIHtcclxuXHJcbiAgICAgIEV2ZW50RmFjdG9yeS5nZXRFdmVudCh7aWQ6IDN9XHJcbiAgICAgICAsIGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgICAkc2NvcGUuZXZlbnREYXRhID0gZXZlbnQ7XHJcbiAgICAgICAgIGNvbnNvbGUubG9nKGV2ZW50KTtcclxuICAgICAgIH1cclxuICAgICAgICwgZnVuY3Rpb24gKGVycm9yKSB7XHJcblxyXG4gICAgICAgfSk7XHJcblxyXG4gICAgICAgICRzY29wZS5hdHRlbmRpbmdEZXNjcmlwdGlvbiA9IFwiSk9JTlwiO1xyXG4gICAgICAgIGlmICgkc2NvcGUuZXZlbnREYXRhLmF0dGVuZGluZykge1xyXG4gICAgICAgICAgJHNjb3BlLmF0dGVuZGluZ0Rlc2NyaXB0aW9uID0gXCJDQU5DRUxcIlxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgJHNjb3BlLmRvQXR0ZW5kID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgJHNjb3BlLmV2ZW50RGF0YS5hdHRlbmRpbmcgPSAhJHNjb3BlLmV2ZW50RGF0YS5hdHRlbmRpbmc7XHJcbiAgICAgICAgJHNjb3BlLmF0dGVuZGluZ0Rlc2NyaXB0aW9uID0gXCJKT0lOXCI7XHJcbiAgICAgICAgaWYgKCRzY29wZS5ldmVudERhdGEuYXR0ZW5kaW5nKSB7XHJcbiAgICAgICAgICAkc2NvcGUuYXR0ZW5kaW5nRGVzY3JpcHRpb24gPSBcIkNBTkNFTFwiXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gIH0pO1xyXG4iLCJpbXBvcnQge2FwcH0gZnJvbSBcIi4uL2FwcFwiO1xuYXBwLmNvbnRyb2xsZXIoJ0hvbWVDdHJsJywgZnVuY3Rpb24gKCRzY29wZSwgJGxvY2F0aW9uLCBFdmVudFNlcnZpY2UpIHtcclxuICAoZnVuY3Rpb24oKXtcclxuICAgICRzY29wZS5ldmVudHMgPSBbXTtcclxuICB9KSgpXHJcbiAgJHNjb3BlLnJlZnJlc2hFdmVudHMgPSBmdW5jdGlvbigpe1xyXG4gICAgRXZlbnRTZXJ2aWNlLmdldEFsbEV2ZW50cygpLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xyXG4gICAgICAkc2NvcGUuZXZlbnRzID0gcmVzcG9uc2UuZGF0YTtcclxuICAgIH0sIGZ1bmN0aW9uKGVycil7XHJcbiAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICB9KTtcclxuICB9XHJcbiAgJHNjb3BlLnJlZnJlc2hFdmVudHMoKTtcclxuXHJcbiAgJHNjb3BlLmNsaWNrID0gZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgIGlmIChldmVudC5FdmVudERhdGVUaW1lRW5kIDwgbmV3IERhdGUoKSkge1xyXG4gICAgICAkbG9jYXRpb24ucGF0aChcImFwcC9yYXRpbmdcIilcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICRsb2NhdGlvbi5wYXRoKFwiYXBwL2V2ZW50LWRldGFpbFwiKVxyXG4gICAgfVxyXG4gIH1cclxufSk7XHJcbiIsImltcG9ydCB7YXBwfSBmcm9tIFwiLi4vYXBwXCI7XG5hcHAuY29udHJvbGxlcignTGFuZGluZ0N0cmwnLCBmdW5jdGlvbiAoJHNjb3BlLCAkc3RhdGVQYXJhbXMsIEZhY2Vib29rLCBQcm9maWxlU2VydmljZSwgJGxvY2F0aW9uKSB7XHJcbiAgJHNjb3BlLmdldExvZ2luU3RhdHVzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgRmFjZWJvb2subG9nb3V0KCk7XHJcbiAgICBGYWNlYm9vay5nZXRMb2dpblN0YXR1cyhmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xyXG4gICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSAnY29ubmVjdGVkJykge1xyXG5cclxuICAgICAgICAkbG9jYXRpb24ucGF0aCgnYXBwL2hvbWUnKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAkc2NvcGUubG9nZ2VkSW4gPSBmYWxzZTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfTtcclxuXHJcbiAgJHNjb3BlLmZiTG9naW4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICBGYWNlYm9vay5sb2dpbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xyXG4gICAgICAgUHJvZmlsZVNlcnZpY2Uuc2V0UHJvZmlsZUZyb21GYWNlYm9vayhyZXNwb25zZSk7XHJcbiAgICAgICAkbG9jYXRpb24ucGF0aCgnYXBwL3JlZ2lzdHJhdGlvbicpO1xyXG4gICAgfSk7XHJcbiAgfTtcclxufSk7XHJcbiIsImltcG9ydCB7YXBwfSBmcm9tIFwiLi4vYXBwXCI7XG5hcHAuY29udHJvbGxlcignTGF0ZXN0Q3RybCcsIGZ1bmN0aW9uICgkc2NvcGUsICRsb2NhdGlvbikge1xyXG5cclxuXHJcblxyXG4gICRzY29wZS5nb0NyZWF0ZUFuRXZlbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAkbG9jYXRpb24ucGF0aCgnYXBwL3JlZ2lzdHJhdGlvbicpO1xyXG4gIH1cclxuXHJcbiAgJHNjb3BlLmdvSGFtYmFTYWZlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgJGxvY2F0aW9uLnBhdGgoJ2FwcC9ldmVudGRldGFpbC9URU1QJyk7XHJcbiAgfVxyXG59KTtcclxuIiwiaW1wb3J0IHthcHB9IGZyb20gXCIuLi9hcHBcIjtcbmFwcC5jb250cm9sbGVyKCdNYXBDdHJsJywgZnVuY3Rpb24gKCRzY29wZSwgRXZlbnRTZXJ2aWNlLCAkc3RhdGUsICRjb21waWxlLCAkaW9uaWNMb2FkaW5nLCAkbG9jYXRpb24pIHtcclxuICAoZnVuY3Rpb24oKXtcclxuICAgICRzY29wZS5zbGlkZXJEaXN0YW5jZSA9IDEwO1xyXG4gIH0pKClcclxuICAkc2NvcGUubG9hZGluZyA9ICRpb25pY0xvYWRpbmcuc2hvdyh7XHJcbiAgICBjb250ZW50OiAnR2V0dGluZyBjdXJyZW50IGxvY2F0aW9uLi4uJyxcclxuICAgIHNob3dCYWNrZHJvcDogZmFsc2VcclxuICB9KTtcclxuXHJcbiAgJHNjb3BlLnNlYXJjaEJ5TG9jYXRpb24gPSBmdW5jdGlvbigpe1xyXG4gICAgY29uc29sZS5sb2coXCJIZXlcIik7XHJcbiAgICBpZighISRzY29wZS5nQ29vcmRzICYmICEhJHNjb3BlLnNsaWRlckRpc3RhbmNlKXtcclxuICAgICAgY29uc29sZS5sb2coJHNjb3BlLnNsaWRlckRpc3RhbmNlKTtcclxuICAgICAgY29uc29sZS5sb2coJHNjb3BlLmdDb29yZHMubGF0KCkgKyBcIiBcIiArICRzY29wZS5nQ29vcmRzLmxuZygpICk7XHJcbiAgICAgICRsb2NhdGlvbi5wYXRoKCdhcHAvc2VhcmNoP2xhdD0nKyRzY29wZS5nQ29vcmRzLmxhdCgpKyBcIiZsbmdcIiskc2NvcGUuZ0Nvb3Jkcy5sbmcoKStcIiZkaXN0PVwiKyAkc2NvcGUuc2xpZGVyRGlzdGFuY2UpO1xyXG4gICAgfVxyXG4gIH1cclxuICAkc2NvcGUuaW5pdCA9IGZ1bmN0aW9uKCkge1xyXG5cclxuXHJcbiAgICB2YXIgbWFwT3B0aW9ucyA9IHtcclxuICAgICAgem9vbTogMTAsXHJcbiAgICAgIG1hcFR5cGVJZDogZ29vZ2xlLm1hcHMuTWFwVHlwZUlkLlJPQURNQVBcclxuICAgIH07XHJcbiAgICB2YXIgbWFwID0gbmV3IGdvb2dsZS5tYXBzLk1hcChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm1hcFwiKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcE9wdGlvbnMpO1xyXG5cclxuICAgIC8vTWFya2VyICsgaW5mb3dpbmRvdyArIGFuZ3VsYXJqcyBjb21waWxlZCBuZy1jbGlja1xyXG4gICAgLy8gdmFyIGNvbnRlbnRTdHJpbmcgPSBcIjxkaXY+PGEgbmctY2xpY2s9J2NsaWNrVGVzdCgpJz5DbGljayBtZSE8L2E+YT48L2Rpdj5kaXY+XCI7XHJcbiAgICAvLyB2YXIgY29tcGlsZWQgPSAkY29tcGlsZShjb250ZW50U3RyaW5nKSgkc2NvcGUpO1xyXG5cclxuICAgIC8vIHZhciBpbmZvd2luZG93ID0gbmV3IGdvb2dsZS5tYXBzLkluZm9XaW5kb3coe1xyXG4gICAgLy8gICBjb250ZW50OiBjb21waWxlZFswXVxyXG4gICAgLy8gfSk7XHJcblxyXG5cclxuXHJcbiAgICAkc2NvcGUubWFwID0gbWFwO1xyXG4gICAgbmF2aWdhdG9yLmdlb2xvY2F0aW9uLmdldEN1cnJlbnRQb3NpdGlvbihmdW5jdGlvbihwb3MpIHtcclxuICAgICAgY29uc29sZS5sb2cocG9zKTtcclxuICAgICAgJHNjb3BlLm1hcC5zZXRDZW50ZXIobmV3IGdvb2dsZS5tYXBzLkxhdExuZyhwb3MuY29vcmRzLmxhdGl0dWRlLCBwb3MuY29vcmRzLmxvbmdpdHVkZSkpO1xyXG4gICAgICAkc2NvcGUuZ0Nvb3JkcyA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcocG9zLmNvb3Jkcy5sYXRpdHVkZSwgcG9zLmNvb3Jkcy5sb25naXR1ZGUpO1xyXG4gICAgICAkc2NvcGUubWFya2VyID0gbmV3IGdvb2dsZS5tYXBzLk1hcmtlcih7XHJcbiAgICAgICAgcG9zaXRpb246ICRzY29wZS5nQ29vcmRzLFxyXG4gICAgICAgIG1hcDogJHNjb3BlLm1hcCxcclxuICAgICAgICB0aXRsZTogJ1lvdSEnXHJcbiAgICAgIH0pO1xyXG4gICAgICAkc2NvcGUubG9jYXRpb25DaXJjbGUgPSBuZXcgZ29vZ2xlLm1hcHMuQ2lyY2xlKHtcclxuICAgICAgICBzdHJva2VDb2xvcjogJyNGRjAwMDAnLFxyXG4gICAgICAgIHN0cm9rZU9wYWNpdHk6IDAuOCxcclxuICAgICAgICBzdHJva2VXZWlnaHQ6IDIsXHJcbiAgICAgICAgZmlsbENvbG9yOiAnI0ZGMDAwMCcsXHJcbiAgICAgICAgZmlsbE9wYWNpdHk6IDAuMzUsXHJcbiAgICAgICAgbWFwOiAkc2NvcGUubWFwLFxyXG4gICAgICAgIGNlbnRlcjogICRzY29wZS5nQ29vcmRzLFxyXG4gICAgICAgIHJhZGl1czogJHNjb3BlLnNsaWRlckRpc3RhbmNlKjEwMDBcclxuICAgICAgfSk7XHJcbiAgICAgICRpb25pY0xvYWRpbmcuaGlkZSgpO1xyXG4gICAgfSwgZnVuY3Rpb24oZXJyb3IpIHtcclxuICAgICAgYWxlcnQoJ1VuYWJsZSB0byBnZXQgbG9jYXRpb246ICcgKyBlcnJvci5tZXNzYWdlKTtcclxuICAgIH0pO1xyXG4gIH1cclxuICAkc2NvcGUuJHdhdGNoKCdzbGlkZXJEaXN0YW5jZScsIGZ1bmN0aW9uIChuZXdWYWx1ZSwgb2xkVmFsdWUpIHtcclxuICAgIGNvbnNvbGUubG9nKCRzY29wZS5tYXApXHJcbiAgICBpZigkc2NvcGUubWFwICYmICRzY29wZS5sb2NhdGlvbkNpcmNsZSkge1xyXG4gICAgICAkc2NvcGUubG9jYXRpb25DaXJjbGUuc2V0T3B0aW9ucyh7XHJcbiAgICAgICAgcmFkaXVzOiAkc2NvcGUuc2xpZGVyRGlzdGFuY2UqMTAwMFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuICAgIC8vZG8gc29tZXRoaW5nXHJcbiAgfSk7XHJcbn0pO1xyXG4iLCJpbXBvcnQge2FwcH0gZnJvbSBcIi4uL2FwcFwiO1xuYXBwLmNvbnRyb2xsZXIoJ1Byb2ZpbGVDdHJsJywgZnVuY3Rpb24gKCRzY29wZSwgUHJvZmlsZVNlcnZpY2UpIHtcclxuICBQcm9maWxlU2VydmljZS5nZXQoMSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICRzY29wZS51c2VyID0gcmVzcG9uc2UuZGF0YTtcclxuICB9KTtcclxuXHJcbn0pO1xyXG4iLCJpbXBvcnQge2FwcH0gZnJvbSBcIi4uL2FwcFwiO1xuYXBwLmNvbnRyb2xsZXIoJ1JhdGluZ0N0cmwnLCBmdW5jdGlvbiAoJHNjb3BlKSB7XHJcbiAgJHNjb3BlLmV2ZW50ID0ge05hbWU6XCJFdmVudCBOYW1lXCIsRGVzY3JpcHRpb246XCJEZXNjcmlwdGlvblwifVxyXG4gICRzY29wZS5SYXRlPTM7XHJcbiAgJHNjb3BlLnNldFJhdGUgPSBmdW5jdGlvbih2YWwpe1xyXG4gICAgJHNjb3BlLlJhdGUgPSB2YWw7XHJcbiAgfTtcclxuXHJcbiAgY29uc29sZS5sb2coJ0hlcmUnKTtcclxufSk7XHJcbiIsImltcG9ydCB7YXBwfSBmcm9tIFwiLi4vYXBwXCI7XG5hcHAuY29udHJvbGxlcignUmVnaXN0cmF0aW9uQ3RybCcsIGZ1bmN0aW9uICgkc2NvcGUsICRzdGF0ZVBhcmFtcywgUHJvZmlsZVNlcnZpY2UpIHtcclxuICBQcm9maWxlU2VydmljZS5nZXRGYWNlQm9va1Byb2ZpbGUoKS50aGVuKGZ1bmN0aW9uIChwcm9maWxlKSB7XHJcbiAgICAkc2NvcGUudXNlciA9IHByb2ZpbGU7XHJcbiAgfSk7XHJcbiAgLypcclxuICAgKiAgRG9CXHJcbiAgICogIEVtYWlsXHJcbiAgICogIFByb2ZpbGUgUGljdHVyZVxyXG4gICAqL1xyXG4gICRzY29wZS5kb1JlZ2lzdGVyID0gZnVuY3Rpb24gKHZhbGlkKSB7XHJcbiAgICAkc2NvcGUuc3VibWl0dGVkID0gdHJ1ZTtcclxuXHJcblxyXG5cclxuICAgICRzY29wZS51cGRhdGVQYXNzd29yZEVycm9yKCk7XHJcblxyXG4gICAgaWYgKHZhbGlkKSB7XHJcbiAgICAgIC8vTG9hZGluZ1N2Yy5zaG93KCk7XHJcbiAgICAgIC8vVXNlcnMuc2lnbnVwKHt9LCAkc2NvcGUubG9naW5EYXRhXHJcbiAgICAgIC8vICAsIGZ1bmN0aW9uICh1c2VyKSB7XHJcbiAgICAgIC8vICAgIExvY2FsU3RvcmFnZS51c2VyID0gdXNlcjtcclxuICAgICAgLy8gICAgJHNjb3BlLmF1dGhlbnRpY2F0aW9uLnVzZXIgPSB1c2VyO1xyXG4gICAgICAvLyAgICAkbG9jYXRpb24ucGF0aCgndmFsdWF0aW9ucycpO1xyXG4gICAgICAvLyAgICBMb2FkaW5nU3ZjLmhpZGUoKTtcclxuICAgICAgLy8gIH1cclxuICAgICAgLy8gICwgZnVuY3Rpb24gKGVycm9yUmVzcG9uc2UpIHtcclxuICAgICAgLy8gICAgY29uc29sZS5sb2coJ2Vycm9yIHNpZ25pbmcgdXNlciB1cCcpO1xyXG4gICAgICAvLyAgICAkc2NvcGUuZXJyb3IgPSBlcnJvclJlc3BvbnNlLmRhdGEubWVzc2FnZTtcclxuICAgICAgLy8gICAgTG9hZGluZ1N2Yy5oaWRlKCk7XHJcbiAgICAgIC8vICB9KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICRzY29wZS5lcnJvciA9ICdQbGVhc2UgZmlsbCBpbiBhbGwgcmVxdWlyZWQgZmllbGRzJztcclxuICAgIH1cclxuICB9XHJcbn0pO1xyXG4iLCJpbXBvcnQge2FwcH0gZnJvbSBcIi4uL2FwcFwiO1xuYXBwLmNvbnRyb2xsZXIoJ1NlYXJjaEN0cmwnLCBmdW5jdGlvbiAoJHNjb3BlLCAkc3RhdGVQYXJhbXMsIEV2ZW50U2VydmljZSwgJGxvY2F0aW9uKSB7XHJcbiAgICAvL2luaXRcclxuICAgIChmdW5jdGlvbigpe1xyXG4gICAgICBjb25zb2xlLmxvZygkc3RhdGVQYXJhbXMubGF0KTtcclxuICAgICAgY29uc29sZS5sb2coJHN0YXRlUGFyYW1zLmxuZyk7XHJcbiAgICAgIGNvbnNvbGUubG9nKCRzdGF0ZVBhcmFtcy5kaXN0KTtcclxuXHJcbiAgICB9KSgpXHJcbiAgICAkc2NvcGUuZXZlbnRUeXBlID0gW1wiRXZlbnQgVHlwZVwiXTtcclxuICAgICRzY29wZS50eXBlU2VsZWN0ZWQgPSAkc2NvcGUuZXZlbnRUeXBlWzBdO1xyXG4gICAgJHNjb3BlLnNlbGVjdGVkU2VhcmNoID0gMDtcclxuICAgIGlmKCRzdGF0ZVBhcmFtcy5sYXQgJiYgJHN0YXRlUGFyYW1zLmxuZyAmJiRzdGF0ZVBhcmFtcy5kaXN0KXtcclxuICAgICAgJHNjb3BlLnNlbGVjdGVkU2VhcmNoID0gMTtcclxuICAgIH1cclxuICAgICRzY29wZS5ldmVudHNUb0xpc3QgPSBbXVxyXG4gICAgJHNjb3BlLnNlYXJjaEV2ZW50cyA9IGZ1bmN0aW9uKCl7XHJcbiAgICAgIHZhciBzZWFyY2hCeSA9ICRzY29wZS5zZWxlY3RlZFNlYXJjaDtcclxuICAgICAgRXZlbnRTZXJ2aWNlLmdldEFsbEV2ZW50cygpLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgICAkc2NvcGUuZXZlbnRzVG9MaXN0ID0gcmVzcG9uc2UuZGF0YTtcclxuICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XHJcbiAgICAgIH0sIGZ1bmN0aW9uKHJlc3BvbnNlKXtcclxuXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgJHNjb3BlLnNlYXJjaEV2ZW50cygpO1xyXG4gICAgJHNjb3BlLmdldFR5cGVzPWZ1bmN0aW9uKCl7XHJcblxyXG4gICAgICBFdmVudFNlcnZpY2UuZ2V0RXZlbnRUeXBlcygpLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuXHJcbiAgICAgICAgJHNjb3BlLmV2ZW50VHlwZXMgPSBbXTtcclxuICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgcmVzcG9uc2UuZGF0YS5sZW5ndGg7IGkrKyl7XHJcbiAgICAgICAgICAkc2NvcGUuZXZlbnRUeXBlcy5wdXNoKHJlc3BvbnNlLmRhdGFbaV0uTmFtZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnNvbGUubG9nKCRzY29wZS5ldmVudFR5cGVzKVxyXG4gICAgICB9LCBmdW5jdGlvbihyZXNwb25zZSl7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJlcnJvclwiKTtcclxuICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgICAgJHNjb3BlLmdldFR5cGVzKCk7XHJcblxyXG4gICAgJHNjb3BlLnRvZ2dsZUdyb3VwID0gZnVuY3Rpb24oZ3JvdXApe1xyXG4gICAgICBpZiAoJHNjb3BlLmlzR3JvdXBTaG93bihncm91cCkpIHtcclxuICAgICAgICAkc2NvcGUuc2hvd25Hcm91cCA9IG51bGw7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgJHNjb3BlLnNob3duR3JvdXAgPSBncm91cDtcclxuICAgICAgfVxyXG4gICAgfTtcclxuICAgICRzY29wZS50b2dnbGVTZWxlY3Rpb24gPSBmdW5jdGlvbihzZWxlY3RlZCwgZ3JvdXApIHtcclxuICAgICAgJHNjb3BlLnR5cGVTZWxlY3RlZCA9IHNlbGVjdGVkO1xyXG4gICAgICAkc2NvcGUudG9nZ2xlR3JvdXAoZ3JvdXApO1xyXG4gICAgfTtcclxuXHJcbiAgICAkc2NvcGUuaXNHcm91cFNob3duID0gZnVuY3Rpb24odHlwZSwgZ3JvdXApIHtcclxuICAgICAgcmV0dXJuICRzY29wZS5zaG93bkdyb3VwID09PSBncm91cCAmJiAkc2NvcGUudHlwZVNlbGVjdGVkICE9PSB0eXBlO1xyXG4gICAgfTtcclxuICAgICRzY29wZS5pc1Nob3duID0gZnVuY3Rpb24odHlwZSwgZ3JvdXApIHtcclxuICAgICAgcmV0dXJuICRzY29wZS5zaG93bkdyb3VwID09PSBncm91cCAmJiAkc2NvcGUudHlwZVNlbGVjdGVkICE9PSB0eXBlO1xyXG4gICAgfTtcclxuICAgICRzY29wZS5zZXRBY3RpdmVTZWFyY2ggPSBmdW5jdGlvbihzZWxlY3Rpb24pe1xyXG4gICAgICAkc2NvcGUuc2VsZWN0ZWRTZWFyY2ggPSBzZWxlY3Rpb247XHJcbiAgICB9XHJcbiAgICAkc2NvcGUuYWN0aXZlU2VhcmNoID0gZnVuY3Rpb24oc2VsZWN0aW9uKXtcclxuICAgICAgcmV0dXJuICRzY29wZS5zZWxlY3RlZFNlYXJjaCA9PT0gc2VsZWN0aW9uO1xyXG4gICAgfVxyXG4gICAgJHNjb3BlLmZpbHRlclJlc3VsdHMgPSBmdW5jdGlvbihldmVudE9iamVjdCl7XHJcbiAgICAgIGlmKCRzY29wZS50eXBlU2VsZWN0ZWQgPT0gXCJFdmVudCBUeXBlXCIpe1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGlmKCRzY29wZS50eXBlU2VsZWN0ZWQgPT0gZXZlbnRPYmplY3QuRXZlbnRUeXBlLk5hbWUpe1xyXG4gICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgICRzY29wZS5nb01hcCA9IGZ1bmN0aW9uKCl7XHJcbiAgICAgICRsb2NhdGlvbi5wYXRoKCdhcHAvbWFwJyk7XHJcbiAgICB9XHJcbiAgfSk7XHJcbiIsImltcG9ydCB7YXBwfSBmcm9tIFwiLi4vYXBwXCI7XG5hcHAuZmFjdG9yeSgnQ2hhdHMnLCBmdW5jdGlvbiAoKSB7XHJcbiAgLy8gTWlnaHQgdXNlIGEgcmVzb3VyY2UgaGVyZSB0aGF0IHJldHVybnMgYSBKU09OIGFycmF5XHJcblxyXG4gIC8vIFNvbWUgZmFrZSB0ZXN0aW5nIGRhdGFcclxuICB2YXIgY2hhdHMgPSBbe1xyXG4gICAgaWQ6IDAsXHJcbiAgICBuYW1lOiAnQmVuIFNwYXJyb3cnLFxyXG4gICAgbGFzdFRleHQ6ICdZb3Ugb24geW91ciB3YXk/JyxcclxuICAgIGZhY2U6ICdpbWcvYmVuLnBuZydcclxuICB9LCB7XHJcbiAgICBpZDogMSxcclxuICAgIG5hbWU6ICdNYXggTHlueCcsXHJcbiAgICBsYXN0VGV4dDogJ0hleSwgaXRcXCdzIG1lJyxcclxuICAgIGZhY2U6ICdpbWcvbWF4LnBuZydcclxuICB9LCB7XHJcbiAgICBpZDogMixcclxuICAgIG5hbWU6ICdBZGFtIEJyYWRsZXlzb24nLFxyXG4gICAgbGFzdFRleHQ6ICdJIHNob3VsZCBidXkgYSBib2F0JyxcclxuICAgIGZhY2U6ICdpbWcvYWRhbS5qcGcnXHJcbiAgfSwge1xyXG4gICAgaWQ6IDMsXHJcbiAgICBuYW1lOiAnUGVycnkgR292ZXJub3InLFxyXG4gICAgbGFzdFRleHQ6ICdMb29rIGF0IG15IG11a2x1a3MhJyxcclxuICAgIGZhY2U6ICdpbWcvcGVycnkucG5nJ1xyXG4gIH0sIHtcclxuICAgIGlkOiA0LFxyXG4gICAgbmFtZTogJ01pa2UgSGFycmluZ3RvbicsXHJcbiAgICBsYXN0VGV4dDogJ1RoaXMgaXMgd2lja2VkIGdvb2QgaWNlIGNyZWFtLicsXHJcbiAgICBmYWNlOiAnaW1nL21pa2UucG5nJ1xyXG4gIH1dO1xyXG5cclxuICByZXR1cm4ge1xyXG4gICAgYWxsOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiBjaGF0cztcclxuICAgIH0sXHJcbiAgICByZW1vdmU6IGZ1bmN0aW9uIChjaGF0KSB7XHJcbiAgICAgIGNoYXRzLnNwbGljZShjaGF0cy5pbmRleE9mKGNoYXQpLCAxKTtcclxuICAgIH0sXHJcbiAgICBnZXQ6IGZ1bmN0aW9uIChjaGF0SWQpIHtcclxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaGF0cy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIGlmIChjaGF0c1tpXS5pZCA9PT0gcGFyc2VJbnQoY2hhdElkKSkge1xyXG4gICAgICAgICAgcmV0dXJuIGNoYXRzW2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuICB9O1xyXG59KTtcclxuIiwiaW1wb3J0IHthcHB9IGZyb20gXCIuLi9hcHBcIjtcbmFwcC5zZXJ2aWNlKCdFdmVudEZhY3RvcnknLCBbJyRodHRwJywgJ2NvbmZpZycsXHJcbiAgICBmdW5jdGlvbiAoJGh0dHAsIGNvbmZpZykge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGdldEFsbEV2ZW50czogZnVuY3Rpb24oaWQpe1xyXG4gICAgICAgICAgcmV0dXJuICRodHRwLmdldChjb25maWcuYmFzZVNlcnZpY2VVUkwgKyAnL3YxL2V2ZW50cycsIGNvbmZpZyk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBnZXRFdmVudDogZnVuY3Rpb24oaWQpe1xyXG4gICAgICAgICAgcmV0dXJuICRodHRwLmdldChjb25maWcuYmFzZVNlcnZpY2VVUkwgKyAnL3YxL2V2ZW50P2lkPScraWQsIGNvbmZpZylcclxuICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3MocmVzdWx0KXtcclxuXHJcbiAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvcihlcnIpe1xyXG5cclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgfSxcclxuICAgICAgICBjcmVhdGVFdmVudCA6IGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICByZXR1cm4gJGh0dHAucG9zdCgndjEvY3JlYXRlZXZlbnQnLCBldmVudCwgY29uZmlnKTtcclxuICAgICAgICB9XHJcbiAgICAgIH07XHJcbiAgICB9XHJcbl0pO1xyXG4iLCJpbXBvcnQge2FwcH0gZnJvbSBcIi4uL2FwcFwiO1xuYXBwLnNlcnZpY2UoJ0V2ZW50U2VydmljZScsIFsnJGh0dHAnLCAnY29uZmlnJyxcclxuICAgIGZ1bmN0aW9uICgkaHR0cCwgY29uZmlnKSB7XHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgY3JlYXRlRXZlbnQ6IGZ1bmN0aW9uKGRhdGEpe1xyXG4gICAgICAgICAgcmV0dXJuICRodHRwLmdldChjb25maWcuYmFzZVNlcnZpY2VVUkwgKyAnL3YxL2NyZWF0ZWV2ZW50JywgZGF0YSwgY29uZmlnKVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZ2V0QWxsRXZlbnRzOiBmdW5jdGlvbihpZCl7XHJcbiAgICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KGNvbmZpZy5iYXNlU2VydmljZVVSTCArICcvdjEvZXZlbnRzJywgY29uZmlnKVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZ2V0RXZlbnQ6IGZ1bmN0aW9uKGlkKXtcclxuICAgICAgICAgIHJldHVybiAkaHR0cC5nZXQoY29uZmlnLmJhc2VTZXJ2aWNlVVJMICsgJy92MS9ldmVudD9pZD0nK2lkLCBjb25maWcpXHJcbiAgICAgICAgfSxcclxuICAgICAgICBnZXRFdmVudFR5cGVzOiBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgcmV0dXJuICRodHRwLmdldChjb25maWcuYmFzZVNlcnZpY2VVUkwgKyAnL3YxL2V2ZW50LXR5cGVzJywgY29uZmlnKVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZ2V0RXZlbnRCeVVzZXI6IGZ1bmN0aW9uKGlkKXtcclxuICAgICAgICAgIHJldHVybiAkaHR0cC5nZXQoY29uZmlnLmJhc2VTZXJ2aWNlVVJMICsgJy92MS9ldmVudHMtYnktdXNlcicsIGNvbmZpZylcclxuICAgICAgICB9LFxyXG4gICAgICAgIGdldEV2ZW50QnlBdHRlbmRlZTogZnVuY3Rpb24oZGF0YSl7XHJcbiAgICAgICAgICB2YXIgcGFyYW0gPSBPYmplY3Qua2V5cyhkYXRhKTtcclxuICAgICAgICAgIHJldHVybiAkaHR0cC5nZXQoY29uZmlnLmJhc2VTZXJ2aWNlVVJMICsgJy92MS9ldmVudHMtYnktYXR0ZW5kZWU/JytwYXJhbStcIj1cIitkYXRhLnBhcmFtLCBjb25maWcpXHJcbiAgICAgICAgfSxcclxuICAgICAgICBnZXRFdmVudEJ5U3VidXJiOiBmdW5jdGlvbihkYXRhKXtcclxuICAgICAgICAgIHZhciBwYXJhbSA9IE9iamVjdC5rZXlzKGRhdGEpO1xyXG4gICAgICAgICAgcmV0dXJuICRodHRwLmdldChjb25maWcuYmFzZVNlcnZpY2VVUkwgKyAnL3YxL2V2ZW50cy1ieS1zdWJ1cmI/JytwYXJhbStcIj1cIitkYXRhLnBhcmFtLCBjb25maWcpXHJcbiAgICAgICAgfSxcclxuICAgICAgICBnZXRFdmVudEJ5Q29vcmRzOiBmdW5jdGlvbihsYXRpdHVkZSwgbG9uZ2l0dWRlLCByYWRpdXMpe1xyXG4gICAgICAgICAgcmV0dXJuICRodHRwLmdldChjb25maWcuYmFzZVNlcnZpY2VVUkwgKyAnL3YxL2V2ZW50cy1ieS1jb29yZGluYXRlcz9sYXRpdHVkZT0nK2xhdGl0dWRlKycmbG9uZ2l0dWRlPScrbG9uZ2l0dWRlKycmcmFkaXVzPScrcmFkaXVzLCBjb25maWcpXHJcbiAgICAgICAgfVxyXG4gICAgICB9O1xyXG4gICAgfVxyXG5dKTtcclxuIiwiaW1wb3J0IHthcHB9IGZyb20gXCIuLi9hcHBcIjtcbmFwcC5mYWN0b3J5KFwiTG9jYWxTdG9yYWdlXCIsIFsnJHdpbmRvdycsXHJcbiAgZnVuY3Rpb24gKCR3aW5kb3cpIHtcclxuICAgIHZhciBfZmFjZWJvb2tBdXRoID0gbnVsbFxyXG4gICAgdmFyIF9wcm9maWxlSWQgPSAxO1xyXG4gICAgcmV0dXJuIHtcclxuXHJcblxyXG5cclxuICAgICAgc2V0IGZhY2Vib29rQXV0aCh2YWx1ZSkge1xyXG4gICAgICAgIF9mYWNlYm9va0F1dGggPSB2YWx1ZTtcclxuICAgICAgfSxcclxuICAgICAgZ2V0IGZhY2Vib29rQXV0aCgpIHtcclxuICAgICAgICByZXR1cm4gX2ZhY2Vib29rQXV0aDtcclxuICAgICAgfSxcclxuXHJcblxyXG4gICAgfTtcclxuICB9XSk7XHJcbiIsImltcG9ydCB7YXBwfSBmcm9tIFwiLi4vYXBwXCI7XG5hcHAuc2VydmljZSgnTG9jYXRpb25TZXJ2aWNlJywgWyckaHR0cCcsICdjb25maWcnLFxyXG4gICAgZnVuY3Rpb24gKCRodHRwLCBjb25maWcpIHtcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBjcmVhdGVFdmVudDogZnVuY3Rpb24oZGF0YSl7XHJcbiAgICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KGNvbmZpZy5iYXNlU2VydmljZVVSTCArICcvdjEvY3JlYXRlZXZlbnQnLCBkYXRhLCBjb25maWcpXHJcbiAgICAgICAgfSxcclxuICAgICAgICBnZXRBbGxFdmVudHM6IGZ1bmN0aW9uKGlkKXtcclxuICAgICAgICAgIHJldHVybiAkaHR0cC5nZXQoY29uZmlnLmJhc2VTZXJ2aWNlVVJMICsgJy92MS9ldmVudHMnLCBjb25maWcpXHJcbiAgICAgICAgfSxcclxuICAgICAgICBnZXRFdmVudDogZnVuY3Rpb24oaWQpe1xyXG4gICAgICAgICAgcmV0dXJuICRodHRwLmdldChjb25maWcuYmFzZVNlcnZpY2VVUkwgKyAnL3YxL2V2ZW50P2lkPScraWQsIGNvbmZpZylcclxuICAgICAgICB9LFxyXG4gICAgICAgIGdldEV2ZW50QnlVc2VyOiBmdW5jdGlvbihpZCl7XHJcbiAgICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KGNvbmZpZy5iYXNlU2VydmljZVVSTCArICcvdjEvZXZlbnRzYnl1c2VyJywgY29uZmlnKVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZ2V0RXZlbnRCeUF0dGVuZGVlOiBmdW5jdGlvbihkYXRhKXtcclxuICAgICAgICAgIHZhciBwYXJhbSA9IE9iamVjdC5rZXlzKGRhdGEpO1xyXG4gICAgICAgICAgcmV0dXJuICRodHRwLmdldChjb25maWcuYmFzZVNlcnZpY2VVUkwgKyAnL3YxL2V2ZW50c2J5YXR0ZW5kZWU/JytwYXJhbStcIj1cIitkYXRhLnBhcmFtLCBjb25maWcpXHJcbiAgICAgICAgfSxcclxuICAgICAgICBnZXRFdmVudEJ5U3VidXJiOiBmdW5jdGlvbihkYXRhKXtcclxuICAgICAgICAgIHZhciBwYXJhbSA9IE9iamVjdC5rZXlzKGRhdGEpO1xyXG4gICAgICAgICAgcmV0dXJuICRodHRwLmdldChjb25maWcuYmFzZVNlcnZpY2VVUkwgKyAnL3YxL2V2ZW50c2J5c3VidXJiPycrcGFyYW0rXCI9XCIrZGF0YS5wYXJhbSwgY29uZmlnKVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZ2V0RXZlbnRCeUNvb3JkczogZnVuY3Rpb24obGF0aXR1ZGUsIGxvbmdpdHVkZSwgcmFkaXVzKXtcclxuICAgICAgICAgIHJldHVybiAkaHR0cC5nZXQoY29uZmlnLmJhc2VTZXJ2aWNlVVJMICsgJy92MS9ldmVudHNieWNvb3JkaW5hdGVzP2xhdGl0dWRlPScrbGF0aXR1ZGUrJyZsb25naXR1ZGU9Jytsb25naXR1ZGUrJyZyYWRpdXM9JytyYWRpdXMsIGNvbmZpZylcclxuICAgICAgICB9XHJcbiAgICAgIH07XHJcbiAgICB9XHJcbl0pO1xyXG4iLCJpbXBvcnQge2FwcH0gZnJvbSBcIi4uL2FwcFwiO1xuYXBwLnNlcnZpY2UoJ1Byb2ZpbGVTZXJ2aWNlJyxcclxuICBmdW5jdGlvbiAoJGh0dHAsIGNvbmZpZywgbG9jYWxTdG9yYWdlU2VydmljZSwgJHEsRmFjZWJvb2spIHtcclxuICB2YXIgYmFzZSA9IGNvbmZpZy5iYXNlU2VydmljZVVSTCArIFwiL3YxL1wiO1xyXG4gIHZhciBwcm9maWxlS2V5ID0gXCJwcm9maWxlS2V5XCI7XHJcblxyXG4gIHJldHVybiB7XHJcbiAgICBzZXRQcm9maWxlRnJvbUZhY2Vib29rOiBmdW5jdGlvbiAocHJvZmlsZSkge1xyXG4gICAgICBsb2NhbFN0b3JhZ2VTZXJ2aWNlLnNldChwcm9maWxlS2V5LCBwcm9maWxlKTtcclxuICAgIH0sXHJcbiAgICBnZXRBbGw6IGZ1bmN0aW9uIChpZCkge1xyXG4gICAgICByZXR1cm4gJGh0dHAuZ2V0KGJhc2UgKyAndXNlcnMnLCBjb25maWcpO1xyXG4gICAgfSxcclxuICAgIGdldEJ5SWQ6IGZ1bmN0aW9uIChpZCkge1xyXG4gICAgICB2YXIgdmFsID0gaWQgfHwgbG9jYWxTdG9yYWdlLmdldEl0ZW0ocHJvZmlsZUtleSk7XHJcblxyXG4gICAgICByZXR1cm4gJGh0dHAuZ2V0KGJhc2UgKyAndXNlcnM/dXNlcm5hbWU9JyArIHZhbCwgY29uZmlnKTtcclxuXHJcbiAgICB9LFxyXG4gICAgZ2V0QnlVc2VybmFtZTogZnVuY3Rpb24gKGlkKSB7XHJcbiAgICAgIHZhciB2YWwgPSBpZCB8fCBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShwcm9maWxlS2V5KTtcclxuXHJcbiAgICAgIHJldHVybiAkaHR0cC5nZXQoYmFzZSArICd1c2Vycz91c2VybmFtZT0nICsgdmFsLCBjb25maWcpO1xyXG4gICAgfSxcclxuICAgIGdldDogZnVuY3Rpb24gKGlkKSB7XHJcbiAgICAgIHZhciB2YWwgPSBpZCB8fCBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShwcm9maWxlS2V5KTtcclxuXHJcbiAgICAgIHJldHVybiAkaHR0cC5nZXQoYmFzZSArICd1c2VyP2lkPScgKyB2YWwsIGNvbmZpZyk7XHJcblxyXG4gICAgfSxcclxuICAgIGdldFByb2ZpbGVJZDogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgIH0sXHJcbiAgICBnZXRGYWNlQm9va1Byb2ZpbGU6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdmFyIGRlZmVyID0gJHEuZGVmZXIoKTtcclxuXHJcbiAgICAgIEZhY2Vib29rLmFwaSgnL21lJywgZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xyXG4gICAgICAgIHZhciBwcm9mID0ge1xyXG4gICAgICAgICAgRmlyc3ROYW1lczogcmVzcG9uc2UuZmlyc3RfbmFtZSxcclxuICAgICAgICAgIExhc3ROYW1lOiByZXNwb25zZS5sYXN0X25hbWUsXHJcbiAgICAgICAgICBHZW5kZXI6IHJlc3BvbnNlLmdlbmRlclxyXG4gICAgICAgIH07XHJcbiAgICAgICAgZGVmZXIucmVzb2x2ZShwcm9mKTtcclxuICAgICAgfSk7XHJcbiAgICAgIHJldHVybiBkZWZlci5wcm9taXNlO1xyXG5cclxuICAgIH1cclxuICB9O1xyXG59XHJcbik7XHJcbiJdfQ==